<mat-card
  class="mat-elevation-z8">
  <mat-card-header>
    <mat-card-title>Top coins</mat-card-title>
    <mat-card-subtitle>
      <div class="align-content-center">
        Last 24h
        <p-progressSpinner class="ml-2" [style]="{width: '15px', height: '15px'}" styleClass="custom-spinner"
                           strokeWidth="6" fill="var(--surface-ground)" animationDuration="2s"></p-progressSpinner>
      </div>
    </mat-card-subtitle>
  </mat-card-header>
  <mat-card-content>

    <table
      mat-table
      matSort
      matSortActive="price_usd"
      matSortDirection="desc"
      [dataSource]="coins"
      multiTemplateDataRows
      class="mat-elevation-z0 mt-2">

      <ng-container matColumnDef="expand">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let coin">
          <mat-icon color="primary">{{expandedElement !== coin ? 'chevron_right' : 'expand_more'}}</mat-icon>
        </td>
      </ng-container>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <td mat-cell *matCellDef="let coin">
          <img src="{{'./assets/cryptocurrency-icons/' + coin.symbol[0].toLowerCase() + '.svg'}}" width="32" style="vertical-align: middle; margin-right: 10px" alt="Coin Icon"/>
          <span class="image-text" style="vertical-align: center">{{coin.prefLabel[0]}}</span>
        </td>
      </ng-container>

      <ng-container matColumnDef="symbol">
        <th mat-header-cell *matHeaderCellDef>Symbol</th>
        <td mat-cell *matCellDef="let coin">{{coin.symbol[0]}}</td>
      </ng-container>

      <ng-container matColumnDef="price_usdt">
        <th mat-header-cell *matHeaderCellDef class="m-0 p-0">
          <div class="h-full align-items-center justify-content-center align-content-center">Price USDT</div>
        </th>
        <td mat-cell *matCellDef="let coin">{{coin.price_usdt}}</td>
      </ng-container>

      <ng-container matColumnDef="price_other">
        <th mat-header-cell *matHeaderCellDef>Price BTC</th>
        <td mat-cell *matCellDef="let coin">{{coin.price_other}}</td>
      </ng-container>

      <!-- End Columns -->
      <ng-container matColumnDef="expandedDetail">
        <td
          mat-cell
          *matCellDef="let coin"
          [attr.colspan]="columns.length">
          <div class="example-element-detail"
               *ngIf="coin.lineChartOptions?.chart"
               [@detailExpand]="coin == expandedElement ? 'expanded' : 'collapsed'">
            <div class="align-items-center justify-content-center p-2 col-6">
              <div class="lineGraph"
                   *ngIf="coin.lineChartOptions.chart"
                   style="height: 500px; width: 100%">
                <apx-chart
                  [chart]="coin.lineChartOptions?.chart"
                  [series]="coin.lineChartOptions?.series"
                  [xaxis]="coin.lineChartOptions?.xaxis"
                  [noData]="coin.lineChartOptions?.noData"
                  [dataLabels]="coin.lineChartOptions?.dataLabels">

                </apx-chart>
              </div>
            </div>
            <div class="col-6">
              <div class="grid w-full">
                <div class="coinDescription align-items-center justify-content-center pb-6 col-12">
                  <mat-card
                    class="scrollable-content"
                    style="width: 100%; height: 100%; padding: 0;overflow: auto;">
                    <ng-container>
                      <div
                        class="header-shadow"
                        style="margin-bottom: 5px; top: 0; position: sticky; z-index: 1; background-color: inherit; border-bottom: 1px;border-bottom-color: red">
                        <mat-card-header>
                          <div mat-card-avatar [ngStyle]="{'background-image': 'url(' + './assets/cryptocurrency-icons/' + coin.symbol[0].toLowerCase() + '.svg' + ')'}"
                               style="background-size: cover"></div>
                          <mat-card-title>{{coin.prefLabel[0]}}</mat-card-title>
                          <mat-card-subtitle>{{coin.symbol[0]}}</mat-card-subtitle>
                        </mat-card-header>
                      </div>
                    </ng-container>
                    <ng-container
                    style="padding: 0 10px 10px;">
                      <mat-card-content class="hide-scrollbar">
                        <p class="hide-scrollbar" >
                          {{coin.description}}
                        </p>
                      </mat-card-content>
                    </ng-container>
                  </mat-card>
                </div>
                <div class="col-12">
                  <div class="align-items-center justify-content-center "
                       style="text-align: center">
                    <p-button label="Learn More" class="ui-buton-info" routerLink="/details/{{coin.symbol}}"></p-button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="columns"></tr>
      <tr mat-row *matRowDef="let coin; columns: columns;"
          class="example-element-row"
          [class.example-expanded-row]="expandedElement === coin"
          (click)="expandedElement = expandedElement === coin ? null : coin"></tr>
      <tr mat-row *matRowDef="let coin; columns: ['expandedDetail']"
          class="example-detail-row"></tr>
    </table>
  </mat-card-content>
</mat-card>
